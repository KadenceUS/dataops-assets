<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Calendars Methods - My Docs</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Calendars Methods";
        var mkdocs_page_input_path = "references/calendar_methods.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> My Docs
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Project Overview</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../overview/ProjectOverview/">Project Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Transformation References</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../shared_methods/">Shared Methods</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../schedule_summary_methods/">Schedule Summary Methods</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../quotas_methods/">Quotas Methods</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../intake_methods/">Intake Methods</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Calendars Methods</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#use-timestamps-to-update-schedule-status">Use timestamps to update schedule status</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#calendartransform_add_schedule_cancel_dob">CalendarTransform._add_schedule_cancel_dob</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_coreutils.ETL.transform.CalendarTransform._add_schedule_cancel_dob">_add_schedule_cancel_dob</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#prepare-remaining-and-target-data-for-analysis">Prepare remaining and target data for analysis</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#calendartransform_collect_remaining_targets">CalendarTransform._collect_remaining_targets</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_coreutils.ETL.transform.CalendarTransform._collect_remaining_targets">_collect_remaining_targets</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#merge-intake-to-data-entry-on-id">Merge intake to data entry on ID</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#calendartransform_merge_intake_to_another_df_via_col">CalendarTransform._merge_intake_to_another_df_via_col</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_coreutils.ETL.transform.CalendarTransform._merge_intake_to_another_df_via_col">_merge_intake_to_another_df_via_col</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#use-merged-id-data-to-update-data-entry">Use merged id data to update data entry</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#calendartransform_intake_status_to_accumulator">CalendarTransform._intake_status_to_accumulator</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_coreutils.ETL.transform.CalendarTransform._intake_status_to_accumulator">_intake_status_to_accumulator</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#get-counts-of-subjects">Get counts of subjects</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#calendartransform_get_counts_from_status">CalendarTransform._get_counts_from_status</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_coreutils.ETL.transform.CalendarTransform._get_counts_from_status">_get_counts_from_status</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#clean-data-based-on-ids">Clean data based on IDS</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#calendartransform_clean_kadence_ids_by_visit_number">CalendarTransform._clean_kadence_ids_by_visit_number</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_coreutils.ETL.transform.CalendarTransform._clean_kadence_ids_by_visit_number">_clean_kadence_ids_by_visit_number</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#stash-data-for-write-out">Stash data for write out</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#calendartransform_stash_data">CalendarTransform._stash_data</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_coreutils.ETL.transform.CalendarTransform._stash_data">_stash_data</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../common_methods/">Common Methods</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">My Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Transformation References</li>
      <li class="breadcrumb-item active">Calendars Methods</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="calendars-methods">Calendars Methods<a class="headerlink" href="#calendars-methods" title="Permanent link">&para;</a></h1>
<h2 id="use-timestamps-to-update-schedule-status">Use timestamps to update schedule status<a class="headerlink" href="#use-timestamps-to-update-schedule-status" title="Permanent link">&para;</a></h2>
<h3 id="calendartransform_add_schedule_cancel_dob">CalendarTransform._add_schedule_cancel_dob<a class="headerlink" href="#calendartransform_add_schedule_cancel_dob" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="_coreutils.ETL.transform.CalendarTransform._add_schedule_cancel_dob"></a>
    <div class="doc doc-contents first">

        <p>Add boolean flags for schedule and cancelled status. Also calculate age using the date and DOB timestamps.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>data_source</code></b>
                  (<code><span title="string">string</span></code>)
              –
              <div class="doc-md-description">
                <p>String that denotes where to pull data from.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<p><span class="doc-section-title">Examples:</span></p>
    
        <hr />
<pre><code>&gt;&gt;&gt; data_source = "Extract.Data Entry"

    Import Data Entry sheets from the extract step.

&gt;&gt;&gt; data_source = "Extract.Lucious6.Data Entry"

    Import extracted data for source Lucious 6 with key 'Data Entry'.

&gt;&gt;&gt; data_source = "Transformations.2"

    Import results from the second transformation step.
</code></pre>


    </div>

</div><pre><code>Aliases: timestamp_derived_columns
</code></pre>
<p><br></p>
<h2 id="prepare-remaining-and-target-data-for-analysis">Prepare remaining and target data for analysis<a class="headerlink" href="#prepare-remaining-and-target-data-for-analysis" title="Permanent link">&para;</a></h2>
<h3 id="calendartransform_collect_remaining_targets">CalendarTransform._collect_remaining_targets<a class="headerlink" href="#calendartransform_collect_remaining_targets" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="_coreutils.ETL.transform.CalendarTransform._collect_remaining_targets"></a>
    <div class="doc doc-contents first">

        <p>Looks for any remaining or target dataframes extracted from source. This step brings it into memory for the transformation process, and
collects remaining and target into respective dictionaries for easier access.
Results for this step are saved as a list with remaining data in element 0, and targets in element 1.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>remaining_label</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;Remaining&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Substring that denotes the name given to remaining data tables in the calendar configuration file. Defaults to 'Remaining'.</p>
              </div>
            </li>
            <li>
              <b><code>target_label</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;Target&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Substring that denotes the name given to target data tables in the calendar configuration file.. Defaults to 'Target'.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div><pre><code>Aliases: collect_remaining_targets
</code></pre>
<p><br></p>
<h2 id="merge-intake-to-data-entry-on-id">Merge intake to data entry on ID<a class="headerlink" href="#merge-intake-to-data-entry-on-id" title="Permanent link">&para;</a></h2>
<h3 id="calendartransform_merge_intake_to_another_df_via_col">CalendarTransform._merge_intake_to_another_df_via_col<a class="headerlink" href="#calendartransform_merge_intake_to_another_df_via_col" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="_coreutils.ETL.transform.CalendarTransform._merge_intake_to_another_df_via_col"></a>
    <div class="doc doc-contents first">

        <p>This method merges the intake data to another dataframe, typically data entry, using user provided id columns.
It also creates a 0-based index of each row within its group using .cumcount from pandas for the id columns.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>intake_source</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>String that denotes where to pull intake data from.</p>
              </div>
            </li>
            <li>
              <b><code>accumulator_source</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>String that denotes where to pull data from that we wish to accumulate data onto.</p>
              </div>
            </li>
            <li>
              <b><code>intake_id_col</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Column name to merge on in the intake dataframe (i.e. 'Kadence ID')</p>
              </div>
            </li>
            <li>
              <b><code>accumulator_id_col</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Column name to merge on in the accumulator dataframe (i.e. 'ID')</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<p><span class="doc-section-title">Examples:</span></p>
    
        <hr />
<pre><code>&gt;&gt;&gt; intake_source||accumulator_source = "Extract.Data Entry"

    Import Data Entry sheets from the extract step.

&gt;&gt;&gt; intake_source||accumulator_source = "Extract.Lucious6.Data Entry"

    Import extracted data for source Lucious 6 with key 'Data Entry'.

&gt;&gt;&gt; intake_source||accumulator_source = "Transformations.2"

    Import results from the second transformation step.
</code></pre>


    </div>

</div><pre><code>Aliases: merge_by_id
</code></pre>
<p><br></p>
<h2 id="use-merged-id-data-to-update-data-entry">Use merged id data to update data entry<a class="headerlink" href="#use-merged-id-data-to-update-data-entry" title="Permanent link">&para;</a></h2>
<h3 id="calendartransform_intake_status_to_accumulator">CalendarTransform._intake_status_to_accumulator<a class="headerlink" href="#calendartransform_intake_status_to_accumulator" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="_coreutils.ETL.transform.CalendarTransform._intake_status_to_accumulator"></a>
    <div class="doc doc-contents first">

        <p>Use a merged intake and accumulator (typically data entry) to get the intake statuses.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>merged_source</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Transformation step id that has the intake data merged with data entry.</p>
              </div>
            </li>
            <li>
              <b><code>accumulator_source</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Transformation or extraction data to update with intake statuses.</p>
              </div>
            </li>
            <li>
              <b><code>accumulator_id_col</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>Column name to merge on in the accumulator dataframe (i.e. 'ID')</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div><pre><code>Aliases: merge_intake_status
</code></pre>
<p><br></p>
<h2 id="get-counts-of-subjects">Get counts of subjects<a class="headerlink" href="#get-counts-of-subjects" title="Permanent link">&para;</a></h2>
<h3 id="calendartransform_get_counts_from_status">CalendarTransform._get_counts_from_status<a class="headerlink" href="#calendartransform_get_counts_from_status" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="_coreutils.ETL.transform.CalendarTransform._get_counts_from_status"></a>
    <div class="doc doc-contents first">

        <p>Calculates the number of counts for a given data source (generally the intake status enriched data entry) for Unique IDs, Name, Email, and Phone. 
Also looks for historical intake records and DNRs to make sure we get correct counts for this given study.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>data_source</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>String that denotes where to pull data from.</p>
              </div>
            </li>
            <li>
              <b><code>dnr_source</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>String that denotes where to pull DNR data from.</p>
              </div>
            </li>
            <li>
              <b><code>historical_intake_list</code></b>
                  (<code><span title="list">list</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>List of strings that denotes where to pull data from.
                    Defaults to None.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<p><span class="doc-section-title">Examples:</span></p>
    
        <hr />
<pre><code>&gt;&gt;&gt; data_source = "Extract.Data Entry"

    Import Data Entry sheets from the extract step.

&gt;&gt;&gt; data_source = "Extract.Lucious6.Data Entry"

    Import extracted data for source Lucious 6 with key 'Data Entry'.

&gt;&gt;&gt; data_source = "Transformations.2"

    Import results from the second transformation step.

&gt;&gt;&gt; historical_intake_list = ["Extract.Lucious4.Data Entry","Extract.Lucious5.Data Entry"]

    Import historical data from Lucious 4 and Lucious 5.
</code></pre>


    </div>

</div><pre><code>Aliases: get_counts
</code></pre>
<p><br></p>
<h2 id="clean-data-based-on-ids">Clean data based on IDS<a class="headerlink" href="#clean-data-based-on-ids" title="Permanent link">&para;</a></h2>
<h3 id="calendartransform_clean_kadence_ids_by_visit_number">CalendarTransform._clean_kadence_ids_by_visit_number<a class="headerlink" href="#calendartransform_clean_kadence_ids_by_visit_number" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="_coreutils.ETL.transform.CalendarTransform._clean_kadence_ids_by_visit_number"></a>
    <div class="doc doc-contents first">

        <p>Clean up dataframe by kadence ids. Adds the cumulative counts for each name, then use common_methods.id_visit_formula to get the correct ID.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>data_source</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>String that denotes where to pull data from.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<p><span class="doc-section-title">Examples:</span></p>
    
        <hr />
<pre><code>&gt;&gt;&gt; data_source = "Extract.Data Entry"

    Import Data Entry sheets from the extract step.

&gt;&gt;&gt; data_source = "Extract.Lucious6.Data Entry"

    Import extracted data for source Lucious 6 with key 'Data Entry'.

&gt;&gt;&gt; data_source = "Transformations.2"

    Import results from the second transformation step.
</code></pre>


    </div>

</div><pre><code>Aliases: clean_ids
</code></pre>
<p><br></p>
<h2 id="stash-data-for-write-out">Stash data for write out<a class="headerlink" href="#stash-data-for-write-out" title="Permanent link">&para;</a></h2>
<h3 id="calendartransform_stash_data">CalendarTransform._stash_data<a class="headerlink" href="#calendartransform_stash_data" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="_coreutils.ETL.transform.CalendarTransform._stash_data"></a>
    <div class="doc doc-contents first">

        <p>Stash data into parent class instance for load step.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>data_source</code></b>
                  (<code><span title="string">string</span></code>)
              –
              <div class="doc-md-description">
                <p>String that denotes where to pull data from.</p>
              </div>
            </li>
            <li>
              <b><code>destination</code></b>
                  (<code><span title="string">string</span></code>)
              –
              <div class="doc-md-description">
                <p>Destination sheet name.</p>
              </div>
            </li>
            <li>
              <b><code>source_col</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;source&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>Column to look for source spreadsheet information. Loops over these sources to send to the right spreadsheet. Defaults to 'source'.</p>
              </div>
            </li>
            <li>
              <b><code>source_whitelist</code></b>
                  (<code><span title="list">list</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>Optional list of spreadsheets to stash according to source_col.</p>
              </div>
            </li>
            <li>
              <b><code>endpoint</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>If provided, only right out to this endpoint sheet. Defaults to None.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<p><span class="doc-section-title">Examples:</span></p>
    
        <hr />
<pre><code>&gt;&gt;&gt; data_source = "Extract.Data Entry"

    Import Data Entry sheets from the extract step.

&gt;&gt;&gt; data_source = "Extract.Lucious6.Data Entry"

    Import extracted data for source Lucious 6 with key 'Data Entry'.

&gt;&gt;&gt; data_source = "Transformations.2"

    Import results from the second transformation step.
</code></pre>


    </div>

</div><pre><code>Aliases: stash_data
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../intake_methods/" class="btn btn-neutral float-left" title="Intake Methods"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../common_methods/" class="btn btn-neutral float-right" title="Common Methods">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../intake_methods/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../common_methods/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
